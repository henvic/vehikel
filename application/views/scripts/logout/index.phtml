<?php // logout/index.phtml

$registry = Zend_Registry::getInstance();
$config = $registry->get("config");
$this->headTitle("Sign out");
$signedUserInfo = $registry->get("signedUserInfo");
?>
<div class="yui-gc">
<div class="yui-u first">
<?php if(isset($_GET['please']) || $registry->isRegistered("pleaseSignout")):?>
<h2>Logout first</h2>
<p>Either an action you have tried to perform or a section you have tried to access can not be performed as a signed in user to the account <em><?= $this->escape($signedUserInfo['name']) ?> (<?= $this->escape($signedUserInfo['alias']) ?>)</em>. Please, sign out and try again.</p>
<?php endif; ?>
<h2>Sign out of <?= $this->escape($config->applicationname) ?></h2>
<p>If you ever forget to logout from a public computer, sign out all other sessions from this page.</p>
<table class="styled">
<caption>Activity on this account</caption>
<thead><tr><th>Access Type</th><th>Date/Time</th></tr></thead>
<?php $access_time_tmp = new Zend_Date(); foreach($this->open_sessions as $single_activity): ?>
<tr>
<td>Browser</td>
<?php //<td><?= $this->escape($single_activity['remote_addr']); </td>?>
<td><?php
$access_time_tmp->set($single_activity['last_access_timestamp'], Zend_Date::TIMESTAMP);
echo $this->escape($access_time_tmp." GMT ".$access_time_tmp->getGmtOffset()." (".ML_Time::ago($access_time_tmp, Zend_Date::TIMESTAMP).")");
?></td>
</tr>
<?php endforeach; unset($single_activity); unset($access_time_tmp); ?>
</table>
<p>This computer is using IP address <?= $this->escape($_SERVER['REMOTE_ADDR']) ?>.<br /><br />
There may be sessions that have not been signed out.</p>
<?php
if($this->remote_logout_done):
?>
<p><strong>Your other sessions have been signed out!</strong></p>
<?php endif; ?>
<?= $this->logoutForm ?>
</div>
</div>