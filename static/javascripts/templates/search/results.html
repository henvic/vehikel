<div class="container">
<div class="row">
<div class="span2">
<%= facetsHtml %>
</div><!-- end of .span2 -->
<div class="span10">
<span class="muted">
<%
if (total === 0) {
%>
Sua busca não encontrou nenhum documento.
<%
} else {
%>
<%- from %>-<%- to %> de <%- total %> resultados (<%- (result.took / 1000) %><span class="visible-phone">s</span><span class="hidden-phone"> segundos</span>)
<span class="pull-right">
        <div class="btn-group sortable">
            <button class="btn btn-mini dropdown-toggle" data-toggle="dropdown">
                ordenar por
                <%
                if (sort === "") {
                    print("relevância");
                } else if(sort === "price-min") {
                    print("menor preço");
                } else {
                    print("maior preço");
                }
                %>
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li><a href="<%- pageLink(formSerialized, 1, 'price-min') %>" data-sort="price-min">menor preço</a></li>
                <li><a href="<%- pageLink(formSerialized, 1, 'price-max') %>" data-sort="price-max">maior preço</a></li>
                <li><a href="<%- pageLink(formSerialized, 1) %>" data-sort="">relevância</a></li>
            </ul>
        </div>
</span>
<%
}
%>
</span>
<%
var items = result.hits.hits;
var itemsLength = items.length;
%>
<table class="table table-striped table-hover results-table<%= (viewStyle !== 'table') ? ' hidden' : '' %>">
    <%
    for (var itemPos = 0; itemPos < itemsLength; itemPos++) {
    var postSearch = items[itemPos];
    var post = postSearch._source;
    var escapedPostLink = AppParams.webroot + "/" + encodeURIComponent(post.user.username) + "/" + post.id;
    var price = post.price;
    %>
    <tr>
        <td class="span1">
            <%
            if (post.pictures !== undefined && post.pictures !== null && post.pictures[0] !== undefined) {
            var picture = post.pictures[0];
            %>
            <img src="<%- AppParams.imagesCdn %><%- picture.id %>-<%- picture.secret %>-square.jpg" alt="picture">
            <%
            } else {
            %>
            <img src="<%- AppParams.cdn %>images/chevrolet-impala-icon-square.png" alt="picture placeholder">
            <%
            }
            %>
            </td>
        <td>
            <div class="span5">
                <a href="<%= escapedPostLink %>">
                <%
                if (postSearch.highlight !== undefined && postSearch.highlight.title !== undefined) {
                %>
                <%= postSearch.highlight.title %>
                <%
                } else {
                %>
                <%- post.title %>
                <%
                }
                %>
                </a><br />
                <%- post.year %>
                <%
                if (post.km !== "") {
                %>
                <span class="muted"> | </span>
                <%- post.km %> km
                <%
                }
                %>
                </div>
            <div class="span2 special-items">
                <%
                var specialItems = [];

                if (post.armor) {
                    specialItems.push("Blindado");
                }

                if (post.transmission == 'automatic') {
                    specialItems.push("Automático");
                }

                if (post.traction == '4x4') {
                    specialItems.push("4x4");
                }

                var specialItemsLength = specialItems.length;

                for (var specialItemsCounter = 0; specialItemsCounter < specialItemsLength; specialItemsCounter++) {
                %>
                <%- specialItems[specialItemsCounter] %>
                <%

                    if (specialItemsCounter !== specialItemsLength - 1) {
                        %><br /><%
                    }
                }

            %>
            </div>
            </td>
            <td class="post-listing-price"><%- formatMoney(post.price) %></td>
        </tr>
    <%
    }
    %>
</table>
<ul class="thumbnails results-thumbnail<%= (viewStyle === 'table') ? ' hidden' : '' %>">
<%
for (var itemPos = 0; itemPos < itemsLength; itemPos++) {
    var postSearch = items[itemPos];
    var post = postSearch._source;
    var escapedPostLink = AppParams.webroot + "/" + encodeURIComponent(post.user.username) + "/" + post.id;
    var price = post.price;
%>
    <li class="span3">
    <a href="<%= escapedPostLink %>" class="thumbnail post-thumbnail">
        <%
        if (post.pictures !== undefined && post.pictures !== null && post.pictures[0] !== undefined) {
        var picture = post.pictures[0];
        %>
        <img src="<%- AppParams.imagesCdn %><%- picture.id %>-<%- picture.secret %>-small.jpg" alt="picture">
        <%
        } else {
        %>
        <img src="<%- AppParams.cdn %>images/chevrolet-impala-icon-small.png" alt="picture placeholder">
        <%
        }
        %>
        <p>
            <%
            if (postSearch.highlight !== undefined && postSearch.highlight.title !== undefined) {
            %>
            <%= postSearch.highlight.title %>
            <%
            } else {
            %>
            <%- post.title %>
            <%
            }
            %>
            <br />
            <span class="post-listing-price"><%- formatMoney(post.price) %></span><br />
            <span class="post-listing-details">
                <%- post.year %>
                <%
                if (post.km !== "") {
                %>
                <%- post.km %> km
                <%
                }
                %>
            </span><br />
            <%
            if (post.armor) {
            %>
            <span class="label label-important">veículo blindado</span>
            <%
            }

            if (post.transmission == 'automatic') {
            %>
            <span class="label label-info">câmbio automático</span>
            <%
            }

            if (post.traction == '4x4') {
            %>
            <span class="label label-warning">4x4</span>
            <%
            }

            if (post.year <= new Date().getFullYear() - 30) {
            %>
            <span class="label label-inverse">colecionador</span>
            <%
            }
            %>
        </p>
    </a>
    </li>
<%
}
%>
</ul>
<%

if (total !== 0) {
%>
<hr class="lighten" />
<div class="pagination pagination-centered">
<ul>
<%
if (from > 1) {
%>
<li><a href="<%- pageLink(formSerialized, currentPage - 1, sort) %>" data-page="<%- (currentPage - 1) %>" data-sort="<%- sort %>">&larr;</a></li>
<%
} else {
%>
<li class="prev disabled"><a href="<%- pageLink(formSerialized, currentPage, sort) %>" data-page="<%- currentPage %>" data-sort="<%- sort %>">&larr;</a></li>
<%
}

var prev = 0;
for (var page = 1; page <= pages; page++) {
    if (prev + 1 !== page && prev !== 0) {
    %><li><a class="disabled">…</a></li><%
    prev = 0;
    }

    if (page === currentPage) {
    prev = page;
    %><li class="active"><a href="<%- pageLink(formSerialized, page, sort) %>" data-page="<%- page %>" data-sort="<%- sort %>"><%- page %></a></li><%
    } else if (page <= 2 || page >= pages - 1 || (page >= currentPage - 3 && page <= currentPage + 3) || (currentPage <= 8 && page <= 7) || (currentPage >= pages - 8 && page >= pages - 6)) {
    prev = page;
    %><li><a href="<%- pageLink(formSerialized, page, sort) %>" data-page="<%- page %>" data-sort="<%- sort %>"><%- page %></a></li><%
    }
}

if (total > to) {
%>
    <li><a href="<%- pageLink(formSerialized, currentPage + 1, sort) %>" data-page="<%- (currentPage + 1) %>" data-sort="<%- sort %>">&rarr;</a></li>
<%
} else {
%>
    <li class="next disabled"><a href="<%- pageLink(formSerialized, pages, sort) %>" data-page="<%- pages %>" data-sort="<%- sort %>">&rarr;</a></li>
<%
}
%>
</ul>
</div><!-- end of .pagination -->
<%
}
%>
</div><!-- end of .span10 -->
</div><!-- end of .row -->
</div><!-- end of .container -->